module GameCreation where

import Data.IORef
import Control.Monad
import Search
import Operations
import Graphics.UI.GLUT	

stalker :: Int -> IO ()
stalker 5 = return ()

modify_boardstate :: Bool -> Bool -> IORef [Char] -> IORef [Char] -> Integer -> IO ()
modify_boardstate left_click flag board1 boardstate1 i = do
	board <- readIORef board1
	boardstate <- readIORef boardstate1
	if( left_click == True) then
		do
		if (getCharacter boardstate i /= '2') then
			do
				let c = setElement boardstate i '0'
				if  getCharacter board  i == '0' 
					then 
						do
							let b = changeboardstate board boardstate 399
							boardstate1 $~! \x -> b
					else 
						if ( (getNumberofMines board 0  i (-1) []) == 0 )
							then 
								do
									let (_,b)= getAdjacentList board 0 ([i], c) 
									boardstate1 $~! \x -> b
						else boardstate1 $~! \x -> c
		else stalker 5
	else if (flag == True) then
		do
			if (getCharacter boardstate i == '2') then
				do
					let c = setElement boardstate i '1'
					boardstate1 $~! \x -> c
			else
				do
					let c = setElement boardstate i '2'
					boardstate1 $~! \x -> c
	else stalker 5
